<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="pluo的博客"><title>网络编程 | pluo的博客</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">网络编程</h1><a id="logo" href="/.">pluo的博客</a><p class="description">每天进步一点点</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">网络编程</h1><div class="post-meta">Aug 22, 2016<span> | </span><span class="category"><a href="/categories/code/">code</a></span></div><div class="post-content"><p>每个网络应用都是基于客户端—服务器模型的。</p>
<p><strong>IP地址</strong></p>
<p>IP地址结构<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">structure in_addr&#123;</span><br><span class="line"><span class="keyword">unsigned</span> ints_addr; <span class="comment">//网络顺序，大端法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>网络和主机字节顺序转换<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span> <span class="title">htons</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span> hostshort)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">int</span> <span class="title">htonl</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">int</span> hostlong)</span></span>;</span><br><span class="line"><span class="comment">//返回网络字节顺序值</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span> <span class="title">ntohs</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">short</span> intnetshort)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">int</span> <span class="title">ntohl</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">int</span> netlong)</span></span>;</span><br><span class="line"><span class="comment">//返回按照主机字节顺序值</span></span><br></pre></td></tr></table></figure></p>
<p>IP地址和十进制串之间的转换<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">intinet_aton(<span class="keyword">const</span> <span class="keyword">char</span> *<span class="built_in">string</span>, struct in_addr*addr);</span><br><span class="line"><span class="function"><span class="keyword">char</span> * <span class="title">inet_ntoa</span><span class="params">( struct in_addr in)</span></span>;</span><br><span class="line"><span class="comment">//其中 ‘n’ 表示 网络（network）‘a’ 表示 应用（application）</span></span><br></pre></td></tr></table></figure></p>
<p>因特网域名</p>
<p>主机条目结构<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">hostent</span> &#123;</span> </span><br><span class="line">　　 <span class="keyword">char</span> *h_name; <span class="comment">//地址的正式名称</span></span><br><span class="line">　　 <span class="keyword">char</span> **h_aliases; <span class="comment">//空字节-地址的预备名称的指针</span></span><br><span class="line">　　 <span class="keyword">int</span> h_addrtype; <span class="comment">//地址类型，通常是AF_INET</span></span><br><span class="line">　　 <span class="keyword">int</span> h_length; <span class="comment">//地址的比特长度</span></span><br><span class="line">　　 <span class="keyword">char</span> **h_addr_list; <span class="comment">//null-terminated array of in_addr struct</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>DNS查询函数<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;netdb.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">struct hostent *<span class="title">gethostbyname</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> * hostname)</span></span>;</span><br><span class="line"><span class="comment">//成功返回非NULL指针，出错返回NULL并设置h_errno</span></span><br><span class="line"></span><br><span class="line"><span class="function">struct hostent *<span class="title">gethostbyaddr</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> * addr, <span class="keyword">int</span> len, <span class="number">0</span>)</span></span>;</span><br><span class="line"><span class="comment">//成功返回非NULL指针，出错返回NULL并设置h_errno</span></span><br></pre></td></tr></table></figure></p>
<p>打印一个DNS主机条目<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netdb.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> **pp;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">in_addr</span> <span class="title">addr</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">hostent</span> *<span class="title">hostp</span>;</span></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">if</span>(argc != <span class="number">2</span>)&#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>,<span class="string">"usage:%s, error"</span>,argv[<span class="number">0</span>]);  </span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);  </span><br><span class="line">     &#125;</span><br><span class="line">    <span class="keyword">if</span>(inet_aton(argv[<span class="number">1</span>], &amp;addr) != <span class="number">0</span>)</span><br><span class="line">    <span class="comment">//success 关键判断语句 不为0表示 将ip地址点分形式转化为  整数形式成功，说明输入的为 ip地址，而非域名</span></span><br><span class="line">   &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"by addr\n"</span>);  </span><br><span class="line">        hostp = gethostbyaddr((<span class="keyword">const</span> <span class="keyword">char</span>*)&amp;addr, <span class="keyword">sizeof</span>(addr), AF_INET);  </span><br><span class="line">     &#125;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">   &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"by name\n"</span>);  </span><br><span class="line">        hostp = gethostbyname(argv[<span class="number">1</span>]);  </span><br><span class="line">    &#125;</span><br><span class="line">   <span class="built_in">printf</span>(<span class="string">"offical hostname:%s\n"</span>, hostp-&gt;h_name);</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">for</span>(pp = hostp-&gt;h_aliases; *pp != <span class="literal">NULL</span>;pp++)</span><br><span class="line">       <span class="built_in">printf</span>(<span class="string">"alias:%s\n"</span>,*pp);</span><br><span class="line">  </span><br><span class="line">   <span class="keyword">for</span>(pp = hostp-&gt;h_addr_list; *pp != <span class="literal">NULL</span>; pp++)&#123;</span><br><span class="line">       addr.s_addr = ((struct in_addr*)*pp)-&gt;s_addr;</span><br><span class="line">       <span class="built_in">printf</span>(<span class="string">"ip:%s, 0x%x\n"</span>, inet_ntoa(addr), ntohl(addr.s_addr));</span><br><span class="line">     &#125;</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>测试<br>./hostinfo <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a><br>输出<br>by name<br>offical hostname:<a href="http://www.a.shifen.com" target="_blank" rel="noopener">www.a.shifen.com</a><br>alias:<a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a><br>ip:119.75.217.109, 0x774bd96d<br>ip:119.75.218.70, 0x774bda46</p>
<p><strong>套接字接口</strong></p>
<p>套接字地址结构<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//通用socket地址结构（用于connect、bind、accept）</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">socket</span> &#123;</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">short</span> sa_family; <span class="comment">//协议</span></span><br><span class="line">    <span class="keyword">char</span>           sa_data[<span class="number">14</span>]; <span class="comment">//地址</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//因特网socket地址结构</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span> sin_family; <span class="comment">//地址类型,一般为AF_INET</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span> sin_port; <span class="comment">//端口号</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">in_addr</span> <span class="title">sin_addr</span>;</span> <span class="comment">//IP地址</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span>  sin_zero[<span class="number">8</span>]; <span class="comment">//sizeof(sockaddr)</span></span><br><span class="line">&#125;；</span><br></pre></td></tr></table></figure></p>
<p>创建套接字<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">socket</span><span class="params">(<span class="keyword">int</span> domain , <span class="keyword">int</span> type , <span class="keyword">int</span> protocol)</span></span>;</span><br><span class="line"><span class="comment">//成功：返回套接字描述符；失败：-1</span></span><br></pre></td></tr></table></figure></p>
<ol>
<li>domain参数可以指定的通信域（协议族）如下域 说明<br>AF_UNIX  （AF_LOCAL）UNIX域协议（文件系统套接字）<br>AF_INET  ARPA因特网协议（UNIX网络套接字）<br>AF_ISO  ISO标准协议<br>AF_NS  施乐（XEROX）网络系统协议<br>AF_IPX  NOVELL IPX协议<br>AF_APPLETALK<br>Appletalk DDS<br>最常见的套接字域是AF_UNIX和AF_INET，前者用于通过Unix和Linux文件系统实现的本地套接字，后者用于Unix网络套接字。AF_INET套接字可以用于通过包括因特网在内的TCP/IP网络进行通信的程序。</li>
<li>type，套接字类型<br>SOCK_STREAM是一个有序、可靠、面向连接的双字节流。它们是在AF_INET域中通过TCP/IP连接实现的。他们也是AF_UNIX域中常见的套接字类型。<br>SOCK_DGRAM是数据包服务，我们可以用它来发送最大长度固定的消息。但消息是否会被正确传递或消息是否不会乱序到达没有保证。在AF_INET域中通过UDP/IP连接实现，它提供的是一种无需的不可靠服务。<br>SOCK_RAW原始套接字服务。提供一个数据报接口直接访问IP层。绕过传输层协议，需要应用程序构造协议首部。<br>在这三种类型的套接字上建立的协议分别是TCP, UDP，ICMP/IGMP等。</li>
<li>protocol，套接字协议<br>通常为0，表示按给定的域和套接字类型选择默认协议。当同一域和套接字类型支持多个协议时，可以通过protocal(协议)参数 选择特定的协议。<br>在AF_INET通信域中套接字类型SOCK_STREAM的默认协议是TCP。在AF_INET通信域中套接字类型SOCK_DGRAM的默认协议是UDP。</li>
</ol>
<p>建立连接<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">connect</span><span class="params">(<span class="keyword">int</span> socket, <span class="keyword">const</span> struct sockaddr *address, <span class="keyword">size_t</span> address_len)</span></span>;</span><br><span class="line"><span class="comment">//成功返回0，出错返回-1</span></span><br></pre></td></tr></table></figure></p>
<p>绑定<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bind</span><span class="params">(<span class="keyword">int</span> sock, struct sockaddr* addr, <span class="keyword">int</span> addrLen)</span></span>;</span><br><span class="line"><span class="comment">//成功返回0，出错返回-1</span></span><br></pre></td></tr></table></figure></p>
<p>监听<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">listen</span><span class="params">(<span class="keyword">int</span> sockfd, <span class="keyword">int</span> backlog)</span></span>;</span><br><span class="line"><span class="comment">//成功返回0，出错返回-1</span></span><br></pre></td></tr></table></figure></p>
<p>接收连接<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">accept</span><span class="params">(<span class="keyword">int</span> sockfd, struct sockaddr* addr, <span class="keyword">socklen_t</span>* addrlen)</span></span>;</span><br><span class="line"><span class="comment">//成功：返回套接字描述符；失败：-1</span></span><br></pre></td></tr></table></figure></p>
<p>数据传输</p>
<p>发送数据<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ssize_t</span> send(<span class="keyword">int</span> sockfd, <span class="keyword">const</span> <span class="keyword">void</span> *buf, <span class="keyword">size_t</span> len, <span class="keyword">int</span> flags);</span><br><span class="line"><span class="keyword">ssize_t</span> sendto(<span class="keyword">int</span> sockfd, <span class="keyword">const</span> <span class="keyword">void</span> *buf, <span class="keyword">size_t</span> len, <span class="keyword">int</span> flags,</span><br><span class="line">        <span class="keyword">const</span> struct sockaddr *dest_addr, <span class="keyword">socklen_t</span> addrlen);</span><br><span class="line"><span class="keyword">ssize_t</span> sendmsg(<span class="keyword">int</span> sockfd, <span class="keyword">const</span> struct msghdr *msg, <span class="keyword">int</span> flags);</span><br><span class="line"><span class="comment">//成功返回发送的字节数，出错返回-1</span></span><br></pre></td></tr></table></figure></p>
<p>send 函数类似 write ，但它支持额外的参数 flags ，可用标志有：</p>
<ul>
<li>MSG_DONTROUTE ：勿将数据路由出本地网络。</li>
<li>MSG_DONTWAIT ：允许非阻塞操作，等价于用 O_NONBLOCK 。</li>
<li>MSG_EOR ：如果协议支持，此为记录结束。</li>
<li>MSG_OOB ：如果协议支持，发送带外数据。</li>
</ul>
<p>send 成功返回只代表数据已经正确发送到网络上，不表示连接另一端的进程接收数据。对于支持为报文设限的协议，如果报文大小超过协议支持的最大值， send 失败并设 errno 为 EMSGSIZE 。对于字节流协议， send 会阻塞直到整个数据被传输。</p>
<p>sendto 和 send 的区别是它支持在无连接的套接字上指定目标地址。无连接的套接字如果在调用 connect 时没有设置目标地址，则不能用 send 。</p>
<p>sendmsg 类似于 writev ，可以指定多重缓冲区来传输数据。结构 msghdr 的定义如下：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">msghdr</span> &#123;</span></span><br><span class="line">    <span class="keyword">void</span>         *msg_name;       <span class="comment">/* 可选地址 */</span></span><br><span class="line">    <span class="keyword">socklen_t</span>     msg_namelen;    <span class="comment">/* 地址大小 */</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">iovec</span> *<span class="title">msg_iov</span>;</span>        <span class="comment">/* I/O缓冲区数组 */</span></span><br><span class="line">    <span class="keyword">size_t</span>        msg_iovlen;     <span class="comment">/* 数组中元素数 */</span></span><br><span class="line">    <span class="keyword">void</span>         *msg_control;    <span class="comment">/* 辅助数据 */</span></span><br><span class="line">    <span class="keyword">size_t</span>        msg_controllen; <span class="comment">/* 辅助数据大小 */</span></span><br><span class="line">    <span class="keyword">int</span>           msg_flags;      <span class="comment">/* 接收到的数据的标志 */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>接收数据<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ssize_t</span> recv(<span class="keyword">int</span> sockfd, <span class="keyword">void</span> *buf, <span class="keyword">size_t</span> len, <span class="keyword">int</span> flags);</span><br><span class="line"><span class="keyword">ssize_t</span> recvfrom(<span class="keyword">int</span> sockfd, <span class="keyword">void</span> *buf, <span class="keyword">size_t</span> len, <span class="keyword">int</span> flags,</span><br><span class="line">        struct sockaddr *src_addr, <span class="keyword">socklen_t</span> *addrlen);</span><br><span class="line"><span class="keyword">ssize_t</span> recvmsg(<span class="keyword">int</span> sockfd, struct msghdr *msg, <span class="keyword">int</span> flags);</span><br><span class="line"><span class="comment">//成功返回接收的消息字节数，无可用消息或对方已按序结束返回0，出错返回-1</span></span><br></pre></td></tr></table></figure></p>
<p>recv 函数类似 read ，但同样它支持额外的参数 flags ，可用标志有：</p>
<ul>
<li>MSG_WAITALL ：等待直到所有数据可用，只对 SOCK_STREAM 有效。</li>
<li>MSG_TRUNC ：返回报文的实际长度，即使被截断。</li>
<li>MSG_PEEK ：返回报文内容但不取走报文。</li>
<li>MSG_OOB ：如果协议支持，接收带外数据。</li>
</ul>
<p>SOCK_DGRAM 和 SOCK_SEQPACKET 套接字类型一次读取就返回整个报文，所以 MSG_WAITALL 对它们没有作用。</p>
<p>如果发送者用 shutdown 结束传输，或网络协议支持顺序关闭且发送端已关闭，则数据接收完之后 recv 返回0。</p>
<p>recvfrom 可以得到发送者的源地址，通常用于无连接套接字。</p>
<p>recvmsg 类似于 readv ，可以将接收到的数据放入多个缓冲区，也可用于想接收辅助数据的情况。 msghdr 结构前面已经说明，从 recvmsg 返回时会设置 msg_flags 字段来表示接收的数据的特性，可能的值有：</p>
<ul>
<li>MSG_DONTWAIT ： recvmsg 处于非阻塞模式。</li>
<li>MSG_TRUNC ：一般数据被截断。</li>
<li>MSG_CTRUNC ：控制数据被截断。</li>
<li>MSG_EOR ：接收到记录结束符。</li>
<li>MSG_OOB ：接收到带外数据。</li>
</ul>
<p>实例</p>
<p>服务端<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MYPORT  8812</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> QUEUE   20</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BUFFER_SIZE 1024</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_filename</span><span class="params">(<span class="keyword">char</span> *filename)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">time_t</span> rawtime;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">tm</span> * <span class="title">timeinfo</span>;</span></span><br><span class="line">    time(&amp;rawtime);</span><br><span class="line">    timeinfo=localtime(&amp;rawtime);</span><br><span class="line">    <span class="built_in">sprintf</span>(filename, <span class="string">"%d-%d-%d"</span>, <span class="number">1900</span>+timeinfo-&gt;tm_year, <span class="number">1</span>+timeinfo-&gt;tm_mon, timeinfo-&gt;tm_mday);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">write_plan</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *filename, <span class="keyword">char</span> *my_plan)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    FILE *fp;</span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">NULL</span>==(fp=fopen(filename, <span class="string">"wt"</span>)))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    fwrite(my_plan, <span class="number">1</span>, <span class="built_in">strlen</span>(my_plan), fp);</span><br><span class="line">    fclose(fp);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">///定义sockfd</span></span><br><span class="line">    <span class="keyword">int</span> server_sockfd = socket(AF_INET,SOCK_STREAM, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">///定义sockaddr_in</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">server_sockaddr</span>;</span></span><br><span class="line">    server_sockaddr.sin_family = AF_INET;</span><br><span class="line">    server_sockaddr.sin_port = htons(MYPORT);</span><br><span class="line">    server_sockaddr.sin_addr.s_addr = htonl(INADDR_ANY);</span><br><span class="line"></span><br><span class="line">    <span class="comment">///bind，成功返回0，出错返回-1</span></span><br><span class="line">    <span class="keyword">if</span>(bind(server_sockfd,(struct sockaddr *)&amp;server_sockaddr,<span class="keyword">sizeof</span>(server_sockaddr))==<span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">"bind"</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">char</span> filename[<span class="number">11</span>];</span><br><span class="line">        <span class="keyword">char</span> my_plan[BUFFER_SIZE];</span><br><span class="line">        <span class="comment">///客户端套接字</span></span><br><span class="line">        <span class="keyword">char</span> buffer[BUFFER_SIZE];</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">client_addr</span>;</span></span><br><span class="line">        <span class="keyword">socklen_t</span> length = <span class="keyword">sizeof</span>(client_addr);</span><br><span class="line">        <span class="keyword">int</span> len=<span class="number">0</span>;</span><br><span class="line">        <span class="comment">///listen，成功返回0，出错返回-1</span></span><br><span class="line">        <span class="keyword">if</span>(listen(server_sockfd,QUEUE) == <span class="number">-1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            perror(<span class="string">"listen"</span>);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">///成功返回非负描述字，出错返回-1</span></span><br><span class="line">        <span class="keyword">int</span> conn = accept(server_sockfd, (struct sockaddr*)&amp;client_addr, &amp;length);</span><br><span class="line">        <span class="keyword">if</span>(conn&lt;<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            perror(<span class="string">"connect"</span>);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">memset</span>(buffer,<span class="number">0</span>,<span class="keyword">sizeof</span>(buffer));</span><br><span class="line">        len = recv(conn, buffer, BUFFER_SIZE,<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">strcmp</span>(buffer,<span class="string">"write_notes"</span>)==<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            get_filename(filename);</span><br><span class="line">            recv(conn, my_plan, BUFFER_SIZE,<span class="number">0</span>);</span><br><span class="line">            write_plan(filename, my_plan);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%s\n"</span>, my_plan);</span><br><span class="line">        &#125;</span><br><span class="line">        close(conn);</span><br><span class="line">    &#125;</span><br><span class="line">    close(server_sockfd);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>客户端<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MY_WINDOW_WIDTH 500</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MY_WINDOW_HEIGHT 400</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MYPORT  8812</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BUFFER_SIZE 1024</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_filename</span><span class="params">(<span class="keyword">char</span> *filename)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">time_t</span> rawtime;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">tm</span> * <span class="title">timeinfo</span>;</span></span><br><span class="line">    time (&amp;rawtime);</span><br><span class="line">    timeinfo = localtime(&amp;rawtime);</span><br><span class="line">    <span class="built_in">sprintf</span>(filename, <span class="string">"%d-%d-%d"</span>, <span class="number">1900</span>+timeinfo-&gt;tm_year, <span class="number">1</span>+timeinfo-&gt;tm_mon, timeinfo-&gt;tm_mday);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">read_plan</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *filename, <span class="keyword">char</span> *my_plan)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    FILE *fp;</span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">NULL</span>==(fp=fopen(filename, <span class="string">"rt"</span>)))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> len=fread(my_plan, <span class="number">1</span>, BUFFER_SIZE, fp);</span><br><span class="line">    my_plan[len]=<span class="string">'\0'</span>;</span><br><span class="line">    fclose(fp);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">write_plan</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *my_plan)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">///定义sockfd</span></span><br><span class="line">    <span class="keyword">int</span> sock_cli = socket(AF_INET,SOCK_STREAM, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">///定义sockaddr_in</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">servaddr</span>;</span></span><br><span class="line">    <span class="built_in">memset</span>(&amp;servaddr, <span class="number">0</span>, <span class="keyword">sizeof</span>(servaddr));</span><br><span class="line">    servaddr.sin_family = AF_INET;</span><br><span class="line">    servaddr.sin_port = htons(MYPORT);  <span class="comment">///服务器端口</span></span><br><span class="line">    servaddr.sin_addr.s_addr = inet_addr(<span class="string">"211.69.198.76"</span>);  <span class="comment">///服务器ip</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">///连接服务器，成功返回0，错误返回-1</span></span><br><span class="line">    <span class="keyword">if</span> (connect(sock_cli, (struct sockaddr *)&amp;servaddr, <span class="keyword">sizeof</span>(servaddr)) &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">"connect"</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> sendbuf[<span class="number">12</span>];</span><br><span class="line">    <span class="keyword">char</span> recvbuf[BUFFER_SIZE];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">strcpy</span>(sendbuf, <span class="string">"write_notes"</span>);</span><br><span class="line">    </span><br><span class="line">    send(sock_cli, sendbuf, <span class="built_in">strlen</span>(sendbuf)+<span class="number">1</span>, <span class="number">0</span>); <span class="comment">///发送</span></span><br><span class="line">    send(sock_cli, my_plan, BUFFER_SIZE, <span class="number">0</span>); <span class="comment">///发送</span></span><br><span class="line"></span><br><span class="line">    close(sock_cli);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> filename[<span class="number">12</span>];</span><br><span class="line">    <span class="keyword">char</span> my_plan[BUFFER_SIZE];</span><br><span class="line">    get_filename(filename);</span><br><span class="line">    read_plan(filename, my_plan);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n%s\n"</span>, <span class="built_in">strlen</span>(my_plan), my_plan);</span><br><span class="line">    write_plan(my_plan);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</div><div class="tags"><a href="/tags/深入理解计算机系统/">深入理解计算机系统</a></div><div class="post-nav"><a class="pre" href="/2016/08/22/life/学习/成为专家/">成为专家 （简书）</a><a class="next" href="/2016/08/22/code/深入理解计算机系统/系统级I-O/">系统级I/O</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/code/">code</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/life/">life</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/并发错误/" style="font-size: 15px;">并发错误</a> <a href="/tags/思考/" style="font-size: 15px;">思考</a> <a href="/tags/学习/" style="font-size: 15px;">学习</a> <a href="/tags/生活-思考/" style="font-size: 15px;">生活 思考</a> <a href="/tags/信息安全/" style="font-size: 15px;">信息安全</a> <a href="/tags/编程/" style="font-size: 15px;">编程</a> <a href="/tags/软件调试/" style="font-size: 15px;">软件调试</a> <a href="/tags/软件测试/" style="font-size: 15px;">软件测试</a> <a href="/tags/深入理解计算机系统/" style="font-size: 15px;">深入理解计算机系统</a> <a href="/tags/操作系统/" style="font-size: 15px;">操作系统</a> <a href="/tags/读书/" style="font-size: 15px;">读书</a> <a href="/tags/阅读/" style="font-size: 15px;">阅读</a> <a href="/tags/C-C/" style="font-size: 15px;">C/C++</a> <a href="/tags/整理/" style="font-size: 15px;">整理</a> <a href="/tags/生活/" style="font-size: 15px;">生活</a> <a href="/tags/思维导图/" style="font-size: 15px;">思维导图</a> <a href="/tags/学习金字塔/" style="font-size: 15px;">学习金字塔</a> <a href="/tags/写作/" style="font-size: 15px;">写作</a> <a href="/tags/宣言/" style="font-size: 15px;">宣言</a> <a href="/tags/心智/" style="font-size: 15px;">心智</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/01/11/code/从实模式进入保护模式/">从实模式进入保护模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/08/life/读《西藏生死书》有感/">读《西藏生死书》有感</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/05/life/我该怎样活着/">我该怎样活着</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/21/code/安全与测试/防御式编程/">防御式编程</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/16/code/安全与测试/调试九法：软硬件错误的排查之道/">调试九法：软硬件错误的排查之道</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/16/code/计算机/安装Fedora24后的工作/">安装Fedora24后的工作</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/10/life/解决问题的逻辑-拒绝懒惰/">解决问题的逻辑---拒绝懒惰</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/09/life/金字塔原理/思考逻辑/">思考逻辑</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/09/life/金字塔原理/表达的逻辑/">表达的逻辑</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/08/life/学习/学习才能新生/">学习才能新生 --- 读《新生---七年就是一辈子》</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://grid.hust.edu.cn/" title="CGCL" target="_blank">CGCL</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">pluo的博客.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>